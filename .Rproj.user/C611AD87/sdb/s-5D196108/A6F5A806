{
    "collab_server" : "",
    "contents" : "#' Heatmap of a single data matrix.\n#'\n#' @param data Matrix. The data matrix to plot.\n#' @param show_color_bar T/F. Whether or not to show the color bar.\n#' @param title String. Optional plot title\n#' @param xlab String. Optional x axis label.\n#' @param ylab String. Optional y axis label.\n#'\n#'\n#' @examples\n#' data <- sample_toy_data()\n#' Y_obs <- data[[2]][['obs']]\n#' data_heatmap(Y_obs)\n#'\n#' @import ggplot2\n#' @export\ndata_heatmap <- function(data, show_color_bar=TRUE, title='', xlab='', ylab=''){\n    # Heatmap of a single data matrix\n    if (!requireNamespace(\"ggplot2\", quietly = TRUE)) {\n        stop(\"The package 'ggplot2' is needed for this function to work. Please install it.\",\n             call. = FALSE)\n    }\n\n    if (!requireNamespace(\"reshape2\", quietly = TRUE)) {\n        stop(\"The package 'reshape2' is needed for this function to work. Please install it.\",\n             call. = FALSE)\n    }\n\n    # could use geom_raster or geom_tile -- I think the former is faster\n    # could add to theme:\n    # panel.border = element_rect(linetype = 1, size=.5, colour = \"grey80\")\n\n    reshaped_data <- as.data.frame(reshape2::melt(data))\n    colnames(reshaped_data) <- c('obs', 'var', 'value')\n\n    ggplot(data=reshaped_data,\n           aes_string(x = 'var', y = 'obs')) +\n    geom_raster(aes_string(fill = 'value'), show.legend=show_color_bar) +\n    scale_fill_gradient2(low='blue', high='red') +\n    theme(panel.background = element_blank(),\n          axis.line = element_blank(),\n          legend.position=\"bottom\") +\n    scale_y_continuous(expand = c(0, 0)) +\n    scale_x_continuous(expand = c(0, 0)) +\n    labs(title=title,\n         x=xlab,\n         y=ylab)\n\n}\n\n#' Heatmaps of several data blocks.\n#'\n#' @param blocks List. List containing matrices to plot.\n#' @param show_color_bar Boolean. Whether or not to display the color bars.\n#'\n#' @examples\n#' library(ggplot2)\n#' library(cowplot)\n#' data = sample_toy_data()\n#' blocks <- lapply(data, function(x) x[['obs']])\n#' data_blocks_heatmap(blocks)\n#'\n#' @export\ndata_blocks_heatmap <- function(blocks, show_color_bar=TRUE){\n\n    if (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n        stop(\"The package 'cowplot' is needed for this function to work. Please install it.\",\n             call. = FALSE)\n    }\n\n    heatmap_list <- list()\n    for(k in 1:length(blocks)){\n        heatmap_list[[k]] <- data_heatmap(blocks[[k]],\n                                          show_color_bar=show_color_bar,\n                                          ylab=ifelse(k==1, 'observation', ''))\n    }\n\n    cowplot::plot_grid(plotlist=heatmap_list)\n}\n\n#' Heatmaps of JIVE decomposition of several blocks.\n#'\n#' @param block_decompositions List containing the K JIVE decomposition lists.\n#'\n#' @examples\n#' data <- sample_toy_data()\n#' library(cowplot)\n#' data_blocks_heatmap(data)\n#'\n#' @export\ndecomposition_heatmaps <- function(block_decompositions){\n    # plots a heatmap of the given jive decomposotion for each data block\n\n    if (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n        stop(\"The package 'cowplot' is needed for this function to work. Please install it.\",\n             call. = FALSE)\n    }\n\n    K <- length(block_decompositions)\n\n    heatmap_list <- list()\n    for(k in 1:K){\n\n        heatmap_list[[k]] <- data_heatmap(block_decompositions[[k]][['obs']],\n                                          ylab=ifelse(k==1, 'observations', ''),\n                                          show_color_bar=FALSE)\n\n        heatmap_list[[K + k]] <- data_heatmap(block_decompositions[[k]][['joint']],\n                                              ylab=ifelse(k==1, 'joint', ''),\n                                              show_color_bar=FALSE)\n\n        heatmap_list[[2*K + k]] <- data_heatmap(block_decompositions[[k]][['individual']],\n                                                ylab=ifelse(k==1, 'individual', ''),\n                                                show_color_bar=FALSE)\n\n        heatmap_list[[3*K + k]] <- data_heatmap(block_decompositions[[k]][['noise']],\n                                                ylab=ifelse(k==1, 'noise', ''),\n                                                show_color_bar=FALSE)\n    }\n\n    cowplot::plot_grid(plotlist=heatmap_list, ncol=K)\n}\n",
    "created" : 1500059837103.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3879929254",
    "id" : "A6F5A806",
    "lastKnownWriteTime" : 1500062941,
    "last_content_update" : 1500062941145,
    "path" : "~/Dropbox/Research/jive/R/ajive/R/heatmaps.R",
    "project_path" : "R/heatmaps.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}